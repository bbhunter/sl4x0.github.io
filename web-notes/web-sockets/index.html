<!doctype html>
<html lang="en-us">
  <head>
    <title>Web Sockets Attacks // 0xSlaxo Blog</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.101.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Abdelrhman Allam" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://sl4x0.github.io/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Web Sockets Attacks"/>
<meta name="twitter:description" content="Websockets Refrences What is WebSocket in Arabic
What are WebSockets? | Web Security Academy
How to Exploit WebSocket | WebSocket for Beginners
WebSockets are widely used in modern web applications. They are initiated over HTTP and provide long-lived connections with asynchronous communication in both directions.
WebSockets are used for various purposes, including user actions and transmitting sensitive information.
Virtually any web security vulnerability that arises with regular HTTP can also arise in relation to WebSockets communications."/>

    <meta property="og:title" content="Web Sockets Attacks" />
<meta property="og:description" content="Websockets Refrences What is WebSocket in Arabic
What are WebSockets? | Web Security Academy
How to Exploit WebSocket | WebSocket for Beginners
WebSockets are widely used in modern web applications. They are initiated over HTTP and provide long-lived connections with asynchronous communication in both directions.
WebSockets are used for various purposes, including user actions and transmitting sensitive information.
Virtually any web security vulnerability that arises with regular HTTP can also arise in relation to WebSockets communications." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sl4x0.github.io/web-notes/web-sockets/" /><meta property="article:section" content="web-notes" />
<meta property="article:published_time" content="2022-08-24T23:48:05+00:00" />
<meta property="article:modified_time" content="2022-08-24T23:48:05+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://sl4x0.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="Abdelrhman Allam" /></a>
      <h1>0xSlaxo Blog</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/about/">About</a>
             | 
          
          <a class="app-header-menu-item" href="/">Home</a>
             | 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
      </nav>
      <p>Security Researcher - CTF Player</p>
      <div class="app-header-social">
        
          <a href="https://github.com/sl4x0" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.facebook.com/sl4x0" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-facebook">
  <title>My facebook</title>
  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg>
          </a>
        
          <a href="https://twitter.com/sl4x0" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>My Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
          <a href="https://linkedin.com/in/sl4x0" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>My Twitter</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Web Sockets Attacks</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Aug 24, 2022
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          5 min read
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://sl4x0.github.io/tags/ws/">WS</a>
              <a class="tag" href="https://sl4x0.github.io/tags/web-notes/">Web-Notes</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="websockets">Websockets</h1>
<h1 id="refrences"><code>Refrences</code></h1>
<p><a href="https://www.youtube.com/watch?v=69t4zZ7KQ7M"> What is WebSocket in Arabic</a></p>
<p><a href="https://portswigger.net/web-security/websockets/what-are-websockets">What are WebSockets? | Web Security Academy</a></p>
<p><a href="https://youtu.be/8M-r71Czjrg">How to Exploit WebSocket | WebSocket for Beginners</a></p>
<hr>
<p>WebSockets are widely used in modern web applications. They are initiated over HTTP and provide long-lived connections with asynchronous communication in both directions.</p>
<p>WebSockets are used for various purposes, including user actions and transmitting sensitive information.</p>
<p>Virtually any web security vulnerability that arises with regular HTTP can also arise in relation to WebSockets communications.</p>
<p><img src="https://user-images.githubusercontent.com/70459751/186188916-4349e973-ce24-489c-8c60-8b416a1f4fac.png" alt="image"></p>
<hr>
<h2 id="manipulating-websocket-traffic"><strong>Manipulating WebSocket traffic</strong></h2>
<p>Finding WebSockets security vulnerabilities generally involves manipulating them in ways that the application doesn&rsquo;t expect. You can do this using Burp Suite.</p>
<h3 id="intercepting-and-modifying-websocket-messages"><strong>Intercepting and modifying WebSocket messages</strong></h3>
<p><a href="https://youtu.be/KbaOay1yOH0">How to test WebSockets with Burp Suite</a></p>
<h3 id="replaying-and-generating-new-websocket-messages"><strong>Replaying and generating new WebSocket messages</strong></h3>
<ul>
<li>In Burp Proxy, select a message in the WebSockets history, or in the Inte or b, and choose &ldquo;Send to Repeater&rdquo; from the context menu.</li>
<li>In Burp Repeater, you can now edit the message that was selected, and send it over and over.</li>
<li>You can enter a new message and send it in either direction, to the client or server.</li>
<li>In the &ldquo;History&rdquo; panel within Burp Repeater, you can view the history of messages that have been transmitted over the
WebSocket connection. This includes messages that you have generated in Burp Repeater, and also any t and anye browser or server via the same connection.</li>
<li>If you want to edit and resend any message in the
history panel, you can do this by selecting the message and choosing &ldquo;Edit and resend&rdquo; from the context menu.</li>
</ul>
<h3 id="manipulating-websocket-connections"><strong>Manipulating WebSocket connections</strong></h3>
<p><a href="https://portswigger.net/web-security/websockets/what-are-websockets#how-are-websocket-connections-established">What are WebSockets? | Web Security Academy</a></p>
<p>There are various situations in which manipulating the WebSocket handshake might be necessary:</p>
<ul>
<li>It can enable you to reach more attack surface.</li>
<li>Some attacks might cause your connection to drop so you need to establish a new one.</li>
<li>Tokens or other data in the original handshake request might be stale and need updating.</li>
</ul>
<p>You can manipulate the WebSocket handshake using Burp Repeater:</p>
<ul>
<li>Send a WebSocket message to Burp Repeater.</li>
<li>In Burp Repeater, click on the pencil icon next to the WebSocket URL. This opens a wizard that lets you attach to an existing
connected WebSocket, clone a connected WebSocket, or reconnect to a disconnected WebSocket.</li>
<li>If you choose to clone a connected WebSocket or reconnect to a disconnected WebSocket, then the wizard will show full
details of the WebSocket handshake request, which you can edit as required before the handshake is performed.</li>
<li>When you click &ldquo;Connect&rdquo;, Burp will attempt to carry out the configured handshake and display the result. If a new WebSocket
the connection was successfully established, you can then use this to send new messages in Burp Repeater.</li>
</ul>
<hr>
<h1 id="websockets-security-vulnerabilities"><strong><code>WebSockets security vulnerabilities</code></strong></h1>
<p>In principle, practically any web security vulnerability might arise in relation to WebSockets:</p>
<ul>
<li>User-supplied input transmitted to the server might be processed in unsafe ways, leading to vulnerabilities such as <a href="https://portswigger.net/web-security/sql-injection">SQL injection</a> or XML external entity injection.</li>
<li>Some blind vulnerabilities reached via WebSockets might only be detectable using <a href="https://portswigger.net/blog/oast-out-of-band-application-security-testing">out-of-band (OAST) techniques</a>.</li>
<li>If attacker-controlled data is transmitted via WebSockets to other application users, then it might lead to <a href="https://portswigger.net/web-security/cross-site-scripting">XSS</a> or other client-side vulnerabilities.</li>
</ul>
<h2 id="manipulating-websocket-messages-to-exploit-vulnerabilities"><strong>Manipulating WebSocket messages to exploit vulnerabilities</strong></h2>
<p>The majority of<code>input-based</code> of inequalities affecting WebSockets can be found and exploited by <a href="https://portswigger.net/web-security/websockets#intercepting-and-modifying-websocket-messages">tampering with the contents of WebSocket messages</a></p>
<p>For example, suppose a chat application uses WebSockets to send chat messages between the browser and the server. When a user types a chat message, a WebSocket message like the following is sent to the server:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;Hello Carlos&#34;</span>}
</span></span></code></pre></div><p>The contents of the message are transmitted (again via WebSockets) to another chat user, and rendered in the user&rsquo;s browser as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>&lt;<span style="color:#f92672">td</span>&gt;<span style="color:#a6e22e">Hello</span> <span style="color:#a6e22e">Carlos</span>&lt;/<span style="color:#f92672">td</span>&gt;
</span></span></code></pre></div><p>In this situation, provided no other input processing or defenses are in play, an attacker can perform a proof-of-concept XSS attack by submitting the following WebSocket message:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;&lt;img src=1 onerror=&#39;alert(1)&#39;&gt;&#34;</span>}
</span></span></code></pre></div><p><a href="https://portswigger.net/web-security/websockets/lab-manipulating-messages-to-exploit-vulnerabilities">Lab: Manipulating WebSocket messages to exploit vulnerabilities | Web Security Academy</a></p>
<hr>
<h2 id="manipulating-the-websocket-handshake-to-exploit-vulnerabilities"><strong>Manipulating the WebSocket handshake to exploit vulnerabilities</strong></h2>
<p>Some WebSockets vulnerabilities can only be found and exploited by <a href="https://portswigger.net/web-security/websockets#manipulating-websocket-connections">manipulating the WebSocket handshake</a>. These vulnerabilities tend to involve design flaws, such as:</p>
<ul>
<li>Misplaced trust in HTTP headers to perform security decisions, such as the <code>X-Forwarded-For</code> header.</li>
<li>Flaws in session handling mechanisms, since the session context in which WebSocket messages are processed, is generally determined by the session context of the handshake message.</li>
<li>Attack surface is introduced by custom HTTP headers used by the application.</li>
</ul>
<p><a href="https://portswigger.net/web-security/websockets/lab-manipulating-handshake-to-exploit-vulnerabilities">Lab: Manipulating the WebSocket handshake to exploit vulnerabilities | Web Security Academy</a></p>
<hr>
<h2 id="using-cross-site-websockets-to-exploit-vulnerabilities">Using cross-site WebSockets to exploit vulnerabilities</h2>
<p>Some WebSockets security vulnerabilities arise when an attacker makes a cross-domain WebSocket connection from a website that the attacker controls.</p>
<p>This is known as a <a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking">cross-site WebSocket hijacking</a> attack, and it involves exploiting a <a href="https://portswigger.net/web-security/csrf">cross-site request forgery</a> (<a href="https://portswigger.net/web-security/csrf">CSRF</a>) vulnerability on a WebSocket handshake. The attack often has a serious 
impact, allowing an attacker to perform privileged actions on behalf of the victim user or capture sensitive data to which the victim user has access.</p>
<p><a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking">Cross-site WebSocket hijacking | Web Security Academy</a></p>
<hr>
<h2 id="how-to-secure-a-websocket-connection">How to secure a WebSocket connection</h2>
<p>To minimize the risk of security vulnerabilities arising with WebSockets, use the following guidelines:</p>
<ul>
<li>Use the <code>wss://</code> protocol (WebSockets over TLS).</li>
<li>Hard code the URL of the WebSockets endpoint, and certainly don&rsquo;t incorporate user-controllable data into this URL.</li>
<li>Protect the WebSocket handshake message against CSRF, to avoid cross-site WebSockets hijacking vulnerabilities.</li>
<li>Treat data received via the WebSocket as untrusted in both directions. Handle data safely on both the server and client ends, to
prevent input-based vulnerabilities such as SQL injection and <a href="https://portswigger.net/web-security/cross-site-scripting">cross-site scripting</a>.</li>
</ul>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
